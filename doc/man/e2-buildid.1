.\" Man page for e2-buildid
.\"
.\" (c)2007 emlix GmbH
.\"
.TH e2-buildid 1 "Aug 2, 2007" "0.1"

.SH NAME
e2-buildid \- computes the build-id for a given result

.SH SYNOPSIS
e2-buildid [OPTION | RESULT ...]

.SH DESCRIPTION
To avoid rebuilding whole projects everytime a change is done, for
each distinct result in a project, a finger print for its sources and
configuration is calculated, called "build id". Result files are
stored in a sub directory to "out/<result>", which is named after the
build-id. This directory is checked to see whether a single result
must be rebuilt due to source changes. Note that the build-id of
dependencies of a result influence the id of the result itself.

For temporary results (mode local), the build id is always the dummy
value "last".

The algorithm for the build id is as follows:

.nf
  bhash(result) :- sha1sum(for r in {dlist(result), result} phash(r))
  dlist(result) :- dependencies for result, including indirect
  phash(result) :- sha1sum(bchroot(result),
                           for f in {proj/chroot,
                                     proj/env,
                                     proj/init/*,
                                     res/result/build-script,
                                     res/result/config:files
                                    } sha1sum(f),
                           for s in sources revisionid(s))
  bchroot(result) :- sha1sum(for g in chrootgroups[result] ghash(g))
  ghash(group) :- sha1sum(for e in chroot/group: server, file)
  revisionid(source:files) :- sha1sum(
        for f in expanded_files_list(source) sha1sum(f) + basename(f))
.fi

The tool \fBe2-ls-project\fR(1) uses the build-id algorithm to check
whether results have been built, when called with the "--status" flag.

\fBe2-buildid\fR writes the build-id for the result and in the build mode
passed in the "RESULT" and "MODE" arguments to standard output.

.SH RETURN VALUE
Normally, exit status is 0. On error, it is non-zero.

.SH OPTIONS
.TP
.BR \-\-all
Compute build-ids for all results (default unless for working copy).
.TP
.BR 
.BR \-\-tag
Compute build-id based on tagged sources from repository.
.TP
.BR \-\-head
Compute build-id for head revision of sources from repository.
.TP
.BR \-\-working\-copy
Show build-id for local working copies: 'last' always.
.TP
.BR \-\-ignore\-env=VARIABLE
Ignore a particular project environment variable when computing the build-id.
.TP
.BR \-\-help
Show usage information.

.P
For further global options, see \fBe2intro\fR(7).

.SH BUGS
Doubtless there are many.

.SH "SEE ALSO"
.BR e2intro (7),
.BR e2-ls-project (1).

.SH AUTHORS
Gordon Hecker, Oskar Schirmer and Felix Winkelmann

.SH COPYRIGHT
(c)2007 emlix GmbH
